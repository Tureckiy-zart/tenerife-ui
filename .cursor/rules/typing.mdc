# üî∑ TypeScript Typing Rules

**Status:** ‚úÖ ACTIVE  
**Priority:** CRITICAL  
**Date Created:** 2025-01-20

---

## üìã Core Rules

### Rule 1: All Components MUST Have Props Interface

**ALWAYS** define a typed Props interface for every component:

```typescript
// ‚úÖ REQUIRED
export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

// ‚ùå FORBIDDEN
export const Button = ({ children, ...rest }) => { ... }
```

**Enforcement:** Build fails if component lacks Props interface.

---

### Rule 2: All Tokens MUST Export Type Unions

**ALWAYS** export type unions via `keyof typeof`:

```typescript
// ‚úÖ REQUIRED
export const spacing = { ... } as const;
export type Spacing = keyof typeof spacing;

// ‚ùå FORBIDDEN
export const spacing = { ... };
// Missing type export
```

**Enforcement:** Build fails if token lacks type union export.

---

### Rule 3: No `any` Type Allowed

**NEVER** use `any` type:

```typescript
// ‚ùå FORBIDDEN
const data: any = ...;
function process(data: any): any { ... }
const items: any[] = [...];
interface Config { [key: string]: any; }

// ‚úÖ USE INSTEAD
const data: unknown = ...;
function process<T>(data: T): T { ... }
const items: Event[] = [...];
interface Config { [key: string]: unknown; }
```

**Exceptions:** Generic utility functions may use constrained `any`:
```typescript
// ‚úÖ ACCEPTABLE for generic utilities only
function debounce<T extends (...args: any[]) => any>(...)
```

**Enforcement:** Build fails if `any`, `any[]`, or `[key: string]: any` found.

---

### Rule 4: No Implicit `any`

**NEVER** rely on implicit `any`:

```typescript
// ‚ùå FORBIDDEN
function process(data) { ... }

// ‚úÖ REQUIRED
function process(data: string) { ... }
```

**Enforcement:** TypeScript strict mode enforces this.

---

### Rule 5: CVA Components MUST Use VariantProps

**ALWAYS** use `VariantProps` for CVA-based components:

```typescript
// ‚úÖ REQUIRED
import { cva, type VariantProps } from "class-variance-authority";

const buttonVariants = cva("...", {
  variants: { ... }
});

export interface ButtonProps
  extends VariantProps<typeof buttonVariants> { ... }
```

**Enforcement:** Build fails if CVA component lacks VariantProps.

---

### Rule 6: All Components MUST Extend Native Types

**ALWAYS** extend appropriate native HTML types:

```typescript
// ‚úÖ REQUIRED
export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement> { ... }

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> { ... }

export interface DivProps
  extends React.HTMLAttributes<HTMLDivElement> { ... }
```

**Enforcement:** Manual review required.

---

### Rule 7: All Event Handlers MUST Be Typed

**ALWAYS** type event handlers explicitly:

```typescript
// ‚úÖ REQUIRED
onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;
onChange?: (event: React.ChangeEvent<HTMLInputElement>) => void;
onSubmit?: (event: React.FormEvent<HTMLFormElement>) => void;

// ‚ùå FORBIDDEN
onClick?: any;
onChange?: (e: any) => void;
```

**Enforcement:** TypeScript strict mode enforces this.

---

### Rule 8: All Tokens MUST Use `as const`

**ALWAYS** use `as const` for token objects:

```typescript
// ‚úÖ REQUIRED
export const spacing = {
  0: "0",
  1: "0.25rem",
} as const;

// ‚ùå FORBIDDEN
export const spacing = {
  0: "0",
  1: "0.25rem",
};
```

**Enforcement:** Manual review or script check.

---

### Rule 9: All Type Exports MUST Be Public

**ALWAYS** export component props types and token type unions:

```typescript
// Component file
export interface ButtonProps { ... }

// Index file
export type { ButtonProps } from "./Button";
```

**Enforcement:** Manual review.

---

### Rule 10: Strict Mode MUST Be Enabled

**ALWAYS** ensure TypeScript strict mode is enabled:

```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    // ... all strict options
  }
}
```

**Enforcement:** `tsconfig.json` must have strict mode enabled.

---

## üö´ Forbidden Patterns

1. ‚ùå `any` type
2. ‚ùå `any[]` arrays
3. ‚ùå `[key: string]: any` index signatures
4. ‚ùå Implicit `any` parameters
5. ‚ùå Untyped props interfaces
6. ‚ùå Untyped event handlers
7. ‚ùå Tokens without `as const`
8. ‚ùå Tokens without type union exports
9. ‚ùå Components without Props interfaces
10. ‚ùå CVA components without VariantProps

---

## ‚úÖ Required Patterns

1. ‚úÖ All components have Props interfaces
2. ‚úÖ All Props extend native HTML types
3. ‚úÖ CVA components use VariantProps
4. ‚úÖ All event handlers are explicitly typed
5. ‚úÖ All tokens use `as const` and export type unions
6. ‚úÖ All hooks have return type interfaces
7. ‚úÖ Use `unknown` instead of `any`
8. ‚úÖ Use generic types for flexibility
9. ‚úÖ Use type guards for type narrowing
10. ‚úÖ Export all public types

---

## üîç Enforcement

### Automated Checks

- **TypeScript Compiler**: Enforces strict mode rules
- **Type Enforcement Script**: Checks for forbidden patterns
- **Pre-commit Hooks**: Run type checks before commit

### Manual Checks

- Code review must verify:
  - All components have Props interfaces
  - All Props extend native types
  - All tokens export type unions
  - No `any` types used

---

**Status:** ‚úÖ ACTIVE  
**Last Updated:** 2025-01-20
